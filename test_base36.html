<!DOCTYPE html>
<html>
<head>
    <title>Base36 Test</title>
</head>
<body>
    <h1>Base36 Encoding/Decoding Test</h1>
    <div id="results"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"></script>
    <script>
        // Custom base36 encoding (uppercase + numbers only)
        function toBase36(str) {
            const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            let result = '';
            for (let i = 0; i < str.length; i++) {
                const code = str.charCodeAt(i);
                // Convert to base 36, pad with leading zero if needed
                const encoded = code.toString(36).toUpperCase().padStart(2, '0');
                result += encoded;
            }
            return result;
        }

        function fromBase36(str) {
            const cleaned = str.replace(/[^A-Z0-9]/g, '').toUpperCase();
            let result = '';
            for (let i = 0; i < cleaned.length; i += 2) {
                const pair = cleaned.substr(i, 2);
                if (pair.length === 2) {
                    const code = parseInt(pair, 36);
                    if (!isNaN(code)) {
                        result += String.fromCharCode(code);
                    }
                }
            }
            return result;
        }

        // Test data
        const testData = ["442", "433"];
        const testJson = JSON.stringify(testData);
        
        console.log("Original JSON:", testJson);
        
        // Test LZ compression + base36
        const compressed = LZString.compress(testJson);
        console.log("LZ compressed:", compressed);
        
        const encoded = toBase36(compressed);
        console.log("Base36 encoded:", encoded);
        
        const decoded = fromBase36(encoded);
        console.log("Base36 decoded:", decoded);
        
        const decompressed = LZString.decompress(decoded);
        console.log("LZ decompressed:", decompressed);
        
        try {
            const parsed = JSON.parse(decompressed);
            console.log("Final parsed:", parsed);
            console.log("SUCCESS: Round trip worked!");
        } catch (e) {
            console.error("FAILED:", e.message);
        }

        // Display results
        document.getElementById('results').innerHTML = `
            <p><strong>Original:</strong> ${testJson}</p>
            <p><strong>LZ Compressed:</strong> ${compressed}</p>
            <p><strong>Base36 Encoded:</strong> ${encoded}</p>
            <p><strong>Base36 Decoded:</strong> ${decoded}</p>
            <p><strong>LZ Decompressed:</strong> ${decompressed}</p>
            <p><strong>Result:</strong> ${decompressed === testJson ? 'SUCCESS' : 'FAILED'}</p>
        `;
    </script>
</body>
</html>
