<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5-a-side Football Formation Builder</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>âš½</text></svg>">
    
    <!-- Open Graph meta tags for social media previews -->
    <meta property="og:title" content="5-a-side Football Formation Builder">
    <meta property="og:description" content="Create and share 5-a-side football formations with custom player names">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://shafeek-tk.github.io/football-formation-builder/5s.html">
    
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:Arial,sans-serif;background:#1a1a1a;color:#fff;overflow-x:hidden}
        
        .header{text-align:center;padding:15px;background:#2a2a2a;box-shadow:0 2px 10px rgba(0,0,0,0.3)}
        .header h1{font-size:20px;margin-bottom:10px;color:#fff}
        .controls{display:flex;justify-content:center;gap:10px;flex-wrap:wrap}
        .controls button{padding:8px 16px;background:#007acc;color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:14px;transition:background 0.2s}
        .controls button:hover{background:#005a99}
        
        .field-container{display:flex;justify-content:center;align-items:center;min-height:calc(100vh - 120px);padding:20px}
        .field{width:80vw;height:60vh;max-width:600px;max-height:400px;background:linear-gradient(to bottom,#2d5a2d 0%,#2d5a2d 50%,#2d5a2d 50%,#2d5a2d 100%);border:3px solid #fff;border-radius:10px;position:relative;margin:0 auto}
        
        .center-line{position:absolute;top:50%;left:0;right:0;height:2px;background:#fff;transform:translateY(-50%)}
        .center-circle{position:absolute;top:50%;left:50%;width:80px;height:80px;border:2px solid #fff;border-radius:50%;transform:translate(-50%,-50%)}
        
        .goal{position:absolute;left:50%;width:60px;height:20px;border:2px solid #fff;transform:translateX(-50%)}
        .goal.top{top:-2px;border-top:none}
        .goal.bottom{bottom:-2px;border-bottom:none}
        
        .player{position:absolute;width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:11px;color:#fff;cursor:move;transition:transform 0.2s;border:2px solid #fff}
        .player:hover{transform:scale(1.1)}
        .player.home{background:#007acc}
        .player.away{background:#dc3545}
        
        .player-name{position:absolute;top:32px;left:50%;transform:translateX(-50%);font-size:8px;color:#fff;text-align:center;white-space:nowrap;pointer-events:none}
        .player-name-input{font-size:9px;margin-top:2px;padding:1px 3px;background:#fff;border-radius:2px;border:1px solid #007acc;color:#000;width:35px;text-align:center}
        
        .footer{position:fixed;bottom:5px;right:5px;font-size:8px;color:#888;opacity:0.6}
        .footer a{color:#888;text-decoration:none}
        
        .mode-toggle{position:fixed;top:20px;right:20px;z-index:1000;display:flex;gap:5px}
        .mode-btn{padding:6px 12px;background:#007acc;color:#fff;border:none;border-radius:20px;font-size:12px;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.3);transition:all 0.2s ease;cursor:pointer}
        .mode-btn:hover{background:#005a99;transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,0.4)}
        .mode-btn.active{background:#28a745;box-shadow:0 2px 8px rgba(40,167,69,0.4)}
        
        .player-controls{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:20px;max-width:800px;margin-left:auto;margin-right:auto}
        .team-section{background:#2a2a2a;padding:15px;border-radius:8px}
        .team-section h3{margin-bottom:10px;font-size:16px;color:#ccc}
        .team-section select{width:100%;padding:8px;background:#333;color:#fff;border:1px solid #555;border-radius:4px;margin-bottom:15px}
        .player-input{width:100%;padding:6px;margin:0;background:#333;color:#fff;border:1px solid #555;border-radius:4px;font-size:12px;min-width:120px}
        .input-label{display:flex;align-items:center;gap:8px;margin:3px 0;}
        .input-number{color:#ccc;font-weight:bold;min-width:35px;font-size:11px}
        .input-position{color:#999;font-size:9px}
        
        @media (max-width:768px){
            .controls{flex-direction:column;align-items:center}
            .controls select,.controls button{width:200px}
            .field{width:95vw;height:55vh}
            .player-controls{grid-template-columns:1fr;gap:15px}
            .mode-toggle{top:10px;right:10px;flex-direction:column;gap:1px}
            .mode-btn{padding:3px 6px;font-size:9px}
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>5-a-side Football Formation Builder</h1>
        <div class="controls">
            <button onclick="shareFormation()">Share</button>
            <button onclick="downloadImage()">Download</button>
        </div>
        <div class="mode-toggle">
            <button class="mode-btn" onclick="window.location.href='index.html'">11v11</button>
            <button class="mode-btn" onclick="window.location.href='7s.html'">7v7</button>
            <button class="mode-btn" onclick="window.location.href='6s.html'">6v6</button>
            <button class="mode-btn active">5v5</button>
        </div>
    </div>
    
    <div class="field-container">
        <div class="field" id="field">
            <div class="center-line"></div>
            <div class="center-circle"></div>
            <div class="goal top"></div>
            <div class="goal bottom"></div>
        </div>
    </div>
    
    <div class="player-controls">
        <div class="team-section">
            <h3>Home Team (Blue)</h3>
            <select id="homeFormation" onchange="updateFormation('home')">
                <option value="2-2">2-2 (GK-2DEF-2ATT)</option>
                <option value="1-3">1-3 (GK-1DEF-3ATT)</option>
                <option value="3-1">3-1 (GK-3DEF-1ATT)</option>
                <option value="2-1-1">2-1-1 (GK-2DEF-1MID-1ATT)</option>
            </select>
            <div id="homePlayers"></div>
        </div>
        
        <div class="team-section">
            <h3>Away Team (Red)</h3>
            <select id="awayFormation" onchange="updateFormation('away')">
                <option value="2-2">2-2 (GK-2DEF-2ATT)</option>
                <option value="1-3">1-3 (GK-1DEF-3ATT)</option>
                <option value="3-1">3-1 (GK-3DEF-1ATT)</option>
                <option value="2-1-1">2-1-1 (GK-2DEF-1MID-1ATT)</option>
            </select>
            <div id="awayPlayers"></div>
        </div>
    </div>
    
    <div class="footer">
        <a href="https://github.com/shafeek-tk/football-formation-builder" target="_blank">GitHub</a>
    </div>

    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
        const formations = {
            '2-2': {
                positions: [
                    {x: 50, y: 90}, // GK
                    {x: 25, y: 70}, {x: 75, y: 70}, // DEF
                    {x: 25, y: 30}, {x: 75, y: 30}  // ATT
                ]
            },
            '1-3': {
                positions: [
                    {x: 50, y: 90}, // GK
                    {x: 50, y: 70}, // DEF
                    {x: 20, y: 30}, {x: 50, y: 30}, {x: 80, y: 30} // ATT
                ]
            },
            '3-1': {
                positions: [
                    {x: 50, y: 90}, // GK
                    {x: 20, y: 70}, {x: 50, y: 70}, {x: 80, y: 70}, // DEF
                    {x: 50, y: 30} // ATT
                ]
            },
            '2-1-1': {
                positions: [
                    {x: 50, y: 90}, // GK
                    {x: 25, y: 70}, {x: 75, y: 70}, // DEF
                    {x: 50, y: 50}, // MID
                    {x: 50, y: 30} // ATT
                ]
            }
        };

        let homeFormationData = formations['2-2'];
        let awayFormationData = formations['2-2'];

        function createPlayer(team, index, x, y) {
            const player = document.createElement('div');
            player.className = `player ${team}`;
            player.style.left = x + '%';
            player.style.top = y + '%';
            player.textContent = index + 1;
            player.setAttribute('data-player-id', `${team}-${index}`);
            
            const playerName = document.createElement('div');
            playerName.className = 'player-name';
            playerName.textContent = `Player ${index + 1}`;
            player.appendChild(playerName);
            
            return player;
        }

        function updateFormation(team) {
            const formationSelect = document.getElementById(`${team}Formation`);
            const formation = formationSelect.value;
            const formationData = formations[formation];
            
            if (team === 'home') {
                homeFormationData = formationData;
            } else {
                awayFormationData = formationData;
            }
            
            renderField();
            createPlayerInputs();
        }

        function renderField() {
            const field = document.getElementById('field');
            const existingPlayers = field.querySelectorAll('.player');
            existingPlayers.forEach(player => player.remove());
            
            // Home team (bottom half)
            homeFormationData.positions.forEach((pos, index) => {
                const adjustedY = 50 + (pos.y - 50) * 0.5; // Keep in bottom half
                const player = createPlayer('home', index, pos.x, adjustedY);
                field.appendChild(player);
            });
            
            // Away team (top half) 
            awayFormationData.positions.forEach((pos, index) => {
                const adjustedY = 50 - (pos.y - 50) * 0.5; // Keep in top half, flipped
                const player = createPlayer('away', index, pos.x, adjustedY);
                field.appendChild(player);
            });
        }

        function createPlayerInputs() {
            const homeContainer = document.getElementById('homePlayers');
            const awayContainer = document.getElementById('awayPlayers');
            
            homeContainer.innerHTML = '';
            awayContainer.innerHTML = '';
            
            // Home team inputs
            homeFormationData.positions.forEach((pos, index) => {
                const label = document.createElement('div');
                label.className = 'input-label';
                label.innerHTML = `
                    <span class="input-number">${index + 1}</span>
                    <input type="text" class="player-input" placeholder="Player ${index + 1}" 
                           data-player-id="home-${index}" oninput="updatePlayerName(this)" 
                           onkeydown="handleTabNavigation(event)">
                `;
                homeContainer.appendChild(label);
            });
            
            // Away team inputs
            awayFormationData.positions.forEach((pos, index) => {
                const label = document.createElement('div');
                label.className = 'input-label';
                label.innerHTML = `
                    <span class="input-number">${index + 1}</span>
                    <input type="text" class="player-input" placeholder="Player ${index + 1}" 
                           data-player-id="away-${index}" oninput="updatePlayerName(this)" 
                           onkeydown="handleTabNavigation(event)">
                `;
                awayContainer.appendChild(label);
            });
        }

        function updatePlayerName(input) {
            const playerId = input.getAttribute('data-player-id');
            const playerElement = document.querySelector(`[data-player-id="${playerId}"]`);
            if (playerElement) {
                const nameElement = playerElement.querySelector('.player-name');
                if (nameElement) {
                    nameElement.textContent = input.value || input.placeholder;
                }
            }
        }

        function handleTabNavigation(event) {
            if (event.key === 'Tab') {
                event.preventDefault();
                const inputs = Array.from(document.querySelectorAll('.player-input'));
                const currentIndex = inputs.indexOf(event.target);
                const nextIndex = event.shiftKey ? 
                    (currentIndex - 1 + inputs.length) % inputs.length : 
                    (currentIndex + 1) % inputs.length;
                inputs[nextIndex].focus();
            }
        }

        function shareFormation() {
            const homeFormation = document.getElementById('homeFormation').value;
            const awayFormation = document.getElementById('awayFormation').value;
            
            const playerNames = {};
            document.querySelectorAll('.player-input').forEach(input => {
                const playerId = input.getAttribute('data-player-id');
                if (input.value.trim()) {
                    playerNames[playerId] = input.value.trim();
                }
            });
            
            const data = {
                home: homeFormation,
                away: awayFormation,
                names: playerNames
            };
            
            const encodedData = btoa(JSON.stringify(data));
            const shareUrl = `${window.location.origin}${window.location.pathname}?data=${encodedData}`;
            
            navigator.clipboard.writeText(shareUrl).then(() => {
                alert('Formation URL copied to clipboard!');
            });
        }

        function downloadImage() {
            const field = document.getElementById('field');
            html2canvas(field, {
                backgroundColor: '#2d5a2d',
                scale: 2
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = '5v5-formation.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        function loadFromUrl() {
            const urlParams = new URLSearchParams(window.location.search);
            const data = urlParams.get('data');
            
            if (data) {
                try {
                    const formationData = JSON.parse(atob(data));
                    
                    if (formationData.home) {
                        document.getElementById('homeFormation').value = formationData.home;
                        updateFormation('home');
                    }
                    
                    if (formationData.away) {
                        document.getElementById('awayFormation').value = formationData.away;
                        updateFormation('away');
                    }
                    
                    if (formationData.names) {
                        setTimeout(() => {
                            Object.entries(formationData.names).forEach(([playerId, name]) => {
                                const input = document.querySelector(`input[data-player-id="${playerId}"]`);
                                if (input) {
                                    input.value = name;
                                    updatePlayerName(input);
                                }
                            });
                        }, 100);
                    }
                } catch (e) {
                    console.error('Error loading formation data:', e);
                }
            }
        }

        // Initialize
        renderField();
        createPlayerInputs();
        loadFromUrl();
    </script>
</body>
</html>
