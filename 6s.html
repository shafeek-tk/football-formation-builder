<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>6v6 Football Formation Builder - Easy Football Lineup</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Create 6-a-side football formations and soccer lineups online. Free tactical board for 6v6 matches, futsal, indoor football, and small-sided games worldwide.">
    <meta name="keywords" content="6v6 football formation, 6-a-side soccer lineup, 6v6 tactics, futsal formations, small sided football, 6 aside soccer, football 6v6 strategy, 6 a side formation, six a side football, 6vs6 soccer, mini football formation, indoor football formation, futsal tactics, street football, cage football, 6 player football, six player soccer, small pitch football, compact formation, 6v6 coaching, football training formation, soccer drill formation, tactical setup 6v6, formation creator 6v6, lineup maker 6v6, team sheet 6v6, squad builder 6v6, football manager 6v6, coaching board 6v6, tactical board 6v6, formation planner 6v6, soccer strategy 6v6, football analysis 6v6, match preparation 6v6, team tactics 6v6, player positioning 6v6, field setup 6v6, game plan 6v6, european futsal, asian futsal, south american futsal, indoor soccer formation, street soccer tactics, recreational football, amateur football 6v6, social football, corporate football, workplace football, community football, park football, beach football 6v6, artificial turf football, 3g pitch football, 4g pitch football, astroturf football, synthetic pitch football, leisure football, casual football, pickup football, informal football, weekend football, evening football, after work football, lunch break football, holiday football, vacation football, tournament football 6v6, league football 6v6, cup football 6v6, championship 6v6, competition 6v6, friendly 6v6, scrimmage 6v6, practice 6v6, training 6v6, drill 6v6, exercise 6v6, workout 6v6, fitness 6v6, conditioning 6v6, skill development 6v6, technique 6v6, tactics 6v6, strategy 6v6, game plan 6v6, match analysis 6v6, performance 6v6, improvement 6v6, coaching 6v6, instruction 6v6, guidance 6v6, mentoring 6v6, teaching 6v6, learning 6v6, education 6v6, development 6v6, progression 6v6, advancement 6v6">
    <meta name="geo.region" content="GB, DE, FR, IT, ES, NL, PT, BE, AT, CH, SE, NO, DK, FI, IS, IE, PL, CZ, SK, HU, RO, BG, HR, SI, EE, LV, LT, GR, CY, MT, LU, BR, AR, CO, PE, CL, EC, UY, PY, BO, VE, GY, SR, GF, JP, KR, CN, IN, TH, VN, MY, SG, ID, PH, AU, NZ, MX, US, CA">
    <meta name="geo.placename" content="Europe, Asia, South America, Global">
    
    <!-- Open Graph meta tags -->
    <meta property="og:title" content="6v6 Football Formation Builder - Create 6-a-side Soccer Lineups">
    <meta property="og:description" content="Free online 6v6 football formation creator. Perfect for futsal, indoor football, and small-sided games worldwide.">
    <meta property="og:url" content="https://easyfootballlineup.com/6s.html">
    <meta property="og:locale" content="en_GB">
    <meta property="og:locale:alternate" content="en_US">
    <meta property="og:locale:alternate" content="es_ES">
    <meta property="og:locale:alternate" content="pt_BR">
    <meta property="og:locale:alternate" content="de_DE">
    <meta property="og:locale:alternate" content="fr_FR">
    <meta property="og:locale:alternate" content="it_IT">
    <meta property="og:locale:alternate" content="nl_NL">
    <meta property="og:locale:alternate" content="ja_JP">
    <meta property="og:locale:alternate" content="ko_KR">
    <meta property="og:locale:alternate" content="zh_CN">
    <meta property="og:locale:alternate" content="hi_IN">
    <meta property="og:locale:alternate" content="th_TH">
    <meta property="og:locale:alternate" content="vi_VN">
    
    <!-- Twitter Card meta tags -->
    <meta name="twitter:title" content="6v6 Football Formation Builder - Futsal & Indoor Soccer Tactics">
    <meta name="twitter:description" content="Create professional 6-a-side football formations for futsal, indoor soccer, and recreational football.">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>âš½</text></svg>">
    
    <!-- Open Graph meta tags for social media previews -->
    <meta property="og:title" content="6-a-side Football Formation Builder">
    <meta property="og:description" content="Create and share 6v6 football formations with custom player names and positions">
    <meta property="og:image" content="https://shafeek-tk.github.io/football-formation-builder/formation-preview.png">
    <meta property="og:url" content="https://shafeek-tk.github.io/football-formation-builder/6s.html">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="6-a-side Football Formation Builder">
    
    <!-- Twitter Card meta tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="6-a-side Football Formation Builder">
    <meta name="twitter:description" content="Create and share 6v6 football formations">
    <meta name="twitter:image" content="https://shafeek-tk.github.io/football-formation-builder/formation-preview.png">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BGH9W2K44G"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-BGH9W2K44G');
    </script>
    
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:system-ui,sans-serif;background:#1a1a1a;color:#fff;padding:10px}
        
        .header{text-align:center;margin-bottom:20px}
        .header h1{font-size:24px;margin-bottom:15px}
        .controls{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:20px}
        .controls select,.controls button{padding:8px 12px;background:#333;color:#fff;border:1px solid #555;border-radius:4px;font-size:14px}
        .controls button{background:#007acc;cursor:pointer}
        .controls button:hover{background:#005a99}
        
        .field-container{display:flex;justify-content:center;margin-bottom:20px}
        .field{width:min(90vw,320px);height:min(65vh,450px);background:#0f5132;border:2px solid #fff;position:relative;border-radius:8px}
        .field::before{content:'';position:absolute;top:50%;left:0;right:0;height:2px;background:#fff}
        .field::after{content:'';position:absolute;top:50%;left:50%;width:50px;height:50px;border:2px solid #fff;border-radius:50%;transform:translate(-50%,-50%)}
        
        .penalty-area{position:absolute;width:22%;height:16%;left:50%;transform:translateX(-50%);border:2px solid #fff}
        .penalty-area.top{top:0}
        .penalty-area.bottom{bottom:0}
        .goal-area{position:absolute;width:10%;height:6%;left:50%;transform:translateX(-50%);border:2px solid #fff}
        .goal-area.top{top:0}
        .goal-area.bottom{bottom:0}
        
        .player{position:absolute;transform:translate(-50%,-50%);text-align:center;cursor:pointer}
        .player-icon{width:min(6vw,22px);height:min(6vw,22px);margin:0 auto;background-size:contain;background-repeat:no-repeat;background-position:center}
        .my-team .player-icon{background-image:url('blue-jersey.png')}
        .opp-team .player-icon{background-image:url('red-jersey.png')}
        .player-number{position:absolute;top:30%;left:50%;transform:translate(-50%,-50%);font-size:min(1.6vw,6px);font-weight:bold;color:#fff;text-shadow:1px 1px 1px rgba(0,0,0,0.8)}
        .player-name{font-size:min(2vw,8px);margin-top:0px;padding:2px 4px;background:linear-gradient(135deg,rgba(0,0,0,0.9),rgba(0,0,0,0.7));border-radius:3px;color:#fff;font-weight:bold;max-width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;border:1px solid rgba(255,255,255,0.2);box-shadow:0 1px 3px rgba(0,0,0,0.5);text-shadow:1px 1px 2px rgba(0,0,0,0.8);transition:all 0.2s ease;min-height:14px;display:block}
        .player-name:hover{background:linear-gradient(135deg,rgba(0,0,0,0.95),rgba(0,0,0,0.8));border-color:rgba(255,255,255,0.4);box-shadow:0 2px 5px rgba(0,0,0,0.7);transform:scale(1.05)}
        .player-name-input{font-size:9px;margin-top:2px;padding:1px 3px;background:#fff;border-radius:2px;border:1px solid #007acc;color:#000;width:35px;text-align:center}
        
        .footer{position:fixed;bottom:5px;right:5px;font-size:10px;color:#aaa;opacity:0.8}
        .footer a{color:#aaa;text-decoration:none}
        
        .mode-toggle{position:fixed;top:20px;right:20px;z-index:1000;display:flex;gap:5px}
        .mode-btn{padding:6px 12px;background:#007acc;color:#fff;border:none;border-radius:20px;font-size:12px;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.3);transition:all 0.2s ease;cursor:pointer}
        .mode-btn:hover{background:#005a99;transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,0.4)}
        .mode-btn.active{background:#28a745;box-shadow:0 2px 8px rgba(40,167,69,0.4)}
        
        .player-controls{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:20px;max-width:800px;margin-left:auto;margin-right:auto}
        .team-section{background:#2a2a2a;padding:15px;border-radius:8px}
        .team-section h3{margin-bottom:10px;font-size:16px;color:#ccc}
        .team-section select{width:100%;padding:8px;background:#333;color:#fff;border:1px solid #555;border-radius:4px;margin-bottom:15px}
        .player-input{width:100%;padding:6px;margin:0;background:#333;color:#fff;border:1px solid #555;border-radius:4px;font-size:12px;min-width:120px}
        .input-label{display:flex;align-items:center;gap:8px;margin:3px 0;}
        .input-number{color:#ccc;font-weight:bold;min-width:35px;font-size:11px}
        
        @media (max-width:768px){
            .controls{flex-direction:column;align-items:center}
            .controls select,.controls button{width:200px}
            .field{width:95vw;height:55vh}
            .player-controls{grid-template-columns:1fr;gap:15px}
            .mode-toggle{position:relative;top:auto;right:auto;margin-top:15px;justify-content:center}
            .mode-btn{padding:6px 12px;font-size:12px}
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Easy Football Lineup - 6v6</h1>
        <p style="color:#ccc;font-size:16px;margin-bottom:15px;max-width:600px;margin-left:auto;margin-right:auto;">Build your 6-a-side formation and get an instant shareable link. No saving, no accounts - just share.</p>
        <div class="controls">
            <button onclick="shareFormation()">Share</button>
            <button onclick="downloadImage()">Download</button>
        </div>
        <div class="mode-toggle">
            <button class="mode-btn" onclick="switchMode('index.html')">11v11</button>
            <button class="mode-btn" onclick="switchMode('7s.html')">7v7</button>
            <button class="mode-btn active">6v6</button>
        </div>
    </div>
    
    <div class="field-container">
        <div class="field" id="field">
            <div class="penalty-area top"></div>
            <div class="goal-area top"></div>
            <div class="penalty-area bottom"></div>
            <div class="goal-area bottom"></div>
        </div>
    </div>
    
    <div class="player-controls">
        <div class="team-section">
            <h3>Home Team (Blue)</h3>
            <select id="myTeamFormation" onchange="loadFormation()">
                <option value="221">2-2-1</option>
                <option value="131">1-3-1</option>
                <option value="212">2-1-2</option>
                <option value="122">1-2-2</option>
                <option value="311">3-1-1</option>
            </select>
            <div id="myTeamInputs"></div>
        </div>
        
        <div class="team-section">
            <h3>Away Team (Red)</h3>
            <select id="oppTeamFormation" onchange="loadFormation()">
                <option value="221">2-2-1</option>
                <option value="131">1-3-1</option>
                <option value="212">2-1-2</option>
                <option value="122">1-2-2</option>
                <option value="311">3-1-1</option>
            </select>
            <div id="oppTeamInputs"></div>
        </div>
    </div>
    
    <div style="text-align:center;padding:20px;background:#2a2a2a;margin:20px auto;max-width:800px;border-radius:8px;">
        <h3 style="color:#fff;margin-bottom:15px;font-size:18px;">Why coaches and players love this tool:</h3>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;text-align:left;">
            <div style="color:#ccc;">
                <strong style="color:#fff;">ðŸ”— Instant Shareable Links</strong><br>
                Create formations and get shareable links instantly - no saving needed
            </div>
            <div style="color:#ccc;">
                <strong style="color:#fff;">ðŸš€ No Setup Required</strong><br>
                No saving, no accounts, no setup - just open and start creating
            </div>
            <div style="color:#ccc;">
                <strong style="color:#fff;">ðŸ“± Works Everywhere</strong><br>
                Use on any device - phone, tablet, or computer
            </div>
        </div>
    </div>
    
    <div class="footer">
        <a target="_blank" href="https://icons8.com/icon/y1jile6KU9QN/t-shirt">t shirt</a> icon by <a target="_blank" href="https://icons8.com">Icons8</a> | 
        Need help? <a href="mailto:easyfootballlineup@gmail.com">easyfootballlineup@gmail.com</a>
    </div>

    <script>
        // 6-a-side formations (6 players per team)
        const formations = {
            '221': [[50], [25, 75], [25, 75], [50]], // 2-2-1: GK, 2 defenders, 2 midfielders, 1 striker
            '131': [[50], [50], [20, 50, 80], [50]], // 1-3-1: GK, 1 defender, 3 midfielders, 1 striker
            '212': [[50], [25, 75], [50], [35, 65]], // 2-1-2: GK, 2 defenders, 1 midfielder, 2 strikers
            '122': [[50], [50], [25, 75], [25, 75]], // 1-2-2: GK, 1 defender, 2 midfielders, 2 strikers
            '311': [[50], [20, 50, 80], [50], [50]] // 3-1-1: GK, 3 defenders, 1 midfielder, 1 striker
        };

        function getLayerY(layerIndex, totalLayers, isMyTeam) {
            if (layerIndex === 0) {
                return isMyTeam ? 95 : 5;
            }
            
            const outfieldLayers = totalLayers - 1;
            const outfieldIndex = layerIndex - 1;
            
            let y;
            if (isMyTeam) {
                if (outfieldLayers === 1) {
                    y = 70;
                } else {
                    const spacing = 30 / (outfieldLayers - 1);
                    y = 85 - (spacing * outfieldIndex);
                }
            } else {
                if (outfieldLayers === 1) {
                    y = 30;
                } else {
                    const spacing = 30 / (outfieldLayers - 1);
                    y = 15 + (spacing * outfieldIndex);
                }
            }
            
            return y;
        }

        function getPlayerY(layerIndex, playerIndex, totalLayers, layerSize, isMyTeam) {
            const baseY = getLayerY(layerIndex, totalLayers, isMyTeam);
            
            if (layerSize >= 3) {
                const isWidePlayer = playerIndex === 0 || playerIndex === layerSize - 1;
                if (isWidePlayer) {
                    return isMyTeam ? baseY - 2 : baseY + 2;
                }
            }
            
            return baseY;
        }

        function createPlayer(x, y, position, team, index) {
            const player = document.createElement('div');
            player.className = `player ${team}`;
            player.style.left = x + '%';
            player.style.top = y + '%';
            const playerId = `${team}-${index}`;
            const playerNumber = Math.floor(index/10) + (index%10) + 1;
            const teamPrefix = team === 'my-team' ? 'MT' : 'OPP';
            const playerName = team === 'my-team' ? `${teamPrefix}${playerNumber}` : '';
            player.setAttribute('data-player-id', playerId);
            player.innerHTML = `
                <div class="player-icon">
                    <div class="player-number">${playerNumber}</div>
                </div>
                <div class="player-name" onclick="editPlayerName(this)">${playerName}</div>
            `;
            return player;
        }

        function loadFormation() {
            const field = document.getElementById('field');
            
            const myFormation = document.getElementById('myTeamFormation')?.value || '221';
            const oppFormation = document.getElementById('oppTeamFormation')?.value || '221';
            
            const existingInputValues = {};
            document.querySelectorAll('input[data-player-id]').forEach(input => {
                const playerId = input.getAttribute('data-player-id');
                if (playerId && input.value.trim()) {
                    existingInputValues[playerId] = input.value;
                }
            });
            
            const myTeamNames = [];
            const oppTeamNames = [];
            document.querySelectorAll('input[data-player-id^="my-team-"]').forEach(input => {
                if (input.value.trim()) {
                    myTeamNames.push(input.value);
                }
            });
            document.querySelectorAll('input[data-player-id^="opp-team-"]').forEach(input => {
                if (input.value.trim()) {
                    oppTeamNames.push(input.value);
                }
            });
            
            field.querySelectorAll('.player').forEach(p => p.remove());
            
            const F = formations[myFormation];
            const O = formations[oppFormation];
            
            // Create field players
            F.forEach((layer, layerIndex) => {
                layer.forEach((x, playerIndex) => {
                    const y = getPlayerY(layerIndex, playerIndex, F.length, layer.length, true);
                    const player = createPlayer(x, y, 'P', 'my-team', layerIndex * 10 + playerIndex);
                    field.appendChild(player);
                });
            });
            
            O.forEach((layer, layerIndex) => {
                layer.forEach((x, playerIndex) => {
                    const y = getPlayerY(layerIndex, playerIndex, O.length, layer.length, false);
                    const player = createPlayer(x, y, 'P', 'opp-team', layerIndex * 10 + playerIndex);
                    field.appendChild(player);
                });
            });
            
            createPlayerInputs('myTeamInputs', F, 'Home Team');
            createPlayerInputs('oppTeamInputs', O, 'Away Team');
            
            // Restore names
            Object.keys(existingInputValues).forEach(playerId => {
                const inputField = document.querySelector(`input[data-player-id="${playerId}"]`);
                if (inputField) {
                    inputField.value = existingInputValues[playerId];
                    updatePlayerName(playerId, existingInputValues[playerId]);
                }
            });
            
            const myTeamInputs = document.querySelectorAll('input[data-player-id^="my-team-"]');
            let myTeamIndex = 0;
            myTeamInputs.forEach(input => {
                if ((!input.value.trim() || input.value.startsWith('MT')) && myTeamIndex < myTeamNames.length) {
                    input.value = myTeamNames[myTeamIndex];
                    const playerId = input.getAttribute('data-player-id');
                    updatePlayerName(playerId, myTeamNames[myTeamIndex]);
                    myTeamIndex++;
                }
            });
            
            const oppTeamInputs = document.querySelectorAll('input[data-player-id^="opp-team-"]');
            let oppTeamIndex = 0;
            oppTeamInputs.forEach(input => {
                if ((!input.value.trim() || input.value.startsWith('OPP')) && oppTeamIndex < oppTeamNames.length) {
                    input.value = oppTeamNames[oppTeamIndex];
                    const playerId = input.getAttribute('data-player-id');
                    updatePlayerName(playerId, oppTeamNames[oppTeamIndex]);
                    oppTeamIndex++;
                }
            });
        }

        function createPlayerInputs(containerId, formation, teamName) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            container.innerHTML = '';
            let playerCount = 0;
            
            formation.forEach((layer, layerIndex) => {
                layer.forEach((x, playerIndex) => {
                    const playerNumber = playerCount + 1;
                    const displayPrefix = teamName.toLowerCase().includes('home') ? 'MT' : 'OPP';
                    const defaultValue = teamName.toLowerCase().includes('home') ? `${displayPrefix}${playerNumber}` : '';
                    const input = document.createElement('input');
                    input.className = 'player-input';
                    input.placeholder = `${displayPrefix}${playerNumber}`;
                    input.value = defaultValue;
                    const teamPrefix = teamName.toLowerCase().includes('home') ? 'my-team' : 'opp-team';
                    const playerId = `${teamPrefix}-${layerIndex * 10 + playerIndex}`;
                    input.setAttribute('data-player-id', playerId);
                    
                    const label = document.createElement('div');
                    label.className = 'input-label';
                    label.innerHTML = `<span class="input-number">#${playerNumber}</span>`;
                    label.appendChild(input);
                    
                    input.addEventListener('input', function() {
                        updatePlayerName(playerId, this.value);
                    });
                    
                    input.addEventListener('focus', function() {
                        this.select();
                    });
                    
                    input.addEventListener('keydown', function(e) {
                        if (e.key === 'Tab') {
                            e.preventDefault();
                            const inputs = container.querySelectorAll('.player-input');
                            const currentIndex = Array.from(inputs).indexOf(this);
                            const nextIndex = (currentIndex + 1) % inputs.length;
                            inputs[nextIndex].focus();
                        }
                    });
                    
                    container.appendChild(label);
                    playerCount++;
                });
            });
        }

        function updatePlayerName(playerId, newName) {
            const playerElement = document.querySelector(`[data-player-id="${playerId}"]`);
            if (playerElement) {
                const nameElement = playerElement.querySelector('.player-name');
                if (nameElement) {
                    nameElement.textContent = newName;
                }
            }
        }

        function editPlayerName(element) {
            const currentName = element.textContent;
            const playerId = element.getAttribute('data-player-id') || element.parentElement.getAttribute('data-player-id');
            const input = document.createElement('input');
            input.className = 'player-name-input';
            input.value = currentName;
            
            input.onblur = () => {
                element.textContent = input.value || currentName;
                element.style.display = 'block';
                input.remove();
                
                if (playerId) {
                    const inputField = document.querySelector(`input[data-player-id="${playerId}"]`);
                    if (inputField) {
                        inputField.value = input.value || currentName;
                    }
                }
            };
            
            input.onkeydown = (e) => {
                if (e.key === 'Enter') {
                    input.blur();
                } else if (e.key === 'Tab' && playerId) {
                    e.preventDefault();
                    input.blur();
                    
                    const currentTeam = playerId.split('-')[0] + '-' + playerId.split('-')[1];
                    const allTeamPlayers = document.querySelectorAll(`[data-player-id^="${currentTeam}"] .player-name`);
                    const currentIndex = Array.from(allTeamPlayers).indexOf(element);
                    const nextIndex = (currentIndex + 1) % allTeamPlayers.length;
                    
                    setTimeout(() => {
                        editPlayerName(allTeamPlayers[nextIndex]);
                    }, 50);
                }
            };
            
            element.style.display = 'none';
            element.parentNode.appendChild(input);
            input.focus();
            input.select();
        }

        function switchMode(page) {
            // Track mode switch
            if (typeof gtag !== 'undefined') {
                const targetMode = page.includes('7s') ? '7v7' : page.includes('6s') ? '6v6' : '11v11';
                gtag('event', 'switch_mode', {
                    'event_category': 'navigation',
                    'event_label': targetMode
                });
            }
            
            // Save current names to localStorage for this mode
            const currentMode = window.location.pathname.includes('7s') ? '7v7' : 
                               window.location.pathname.includes('6s') ? '6v6' : '11v11';
            const playerNames = {};
            document.querySelectorAll('.player-input').forEach(input => {
                const playerId = input.getAttribute('data-player-id');
                if (input.value.trim()) {
                    playerNames[playerId] = input.value.trim();
                }
            });
            localStorage.setItem(`footballLineup_${currentMode}`, JSON.stringify(playerNames));
            
            // Create URL with names for immediate transfer
            const encodedNames = btoa(JSON.stringify(playerNames));
            window.location.href = `${page}?names=${encodedNames}`;
        }

        function shareFormation() {
            // Track share event
            if (typeof gtag !== 'undefined') {
                gtag('event', 'share_formation', {
                    'event_category': 'engagement',
                    'event_label': '6v6'
                });
            }
            
            const myFormation = document.getElementById('myTeamFormation')?.value || '221';
            const oppFormation = document.getElementById('oppTeamFormation')?.value || '221';
            
            const myTeamNames = [];
            const oppTeamNames = [];
            
            document.querySelectorAll('.my-team .player-name').forEach(nameEl => {
                myTeamNames.push(nameEl.textContent);
            });
            
            document.querySelectorAll('.opp-team .player-name').forEach(nameEl => {
                oppTeamNames.push(nameEl.textContent);
            });
            
            const formationData = {
                myFormation: myFormation,
                oppFormation: oppFormation,
                myTeamNames: myTeamNames,
                oppTeamNames: oppTeamNames
            };
            
            const encodedData = btoa(JSON.stringify(formationData));
            const url = window.location.origin + window.location.pathname + '#formation=' + encodedData;
            
            // Check if mobile device
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth <= 768;
            
            if (isMobile && navigator.share) {
                navigator.share({
                    title: '6-a-side Football Formation Builder',
                    text: 'Check out this 6v6 football formation!',
                    url: url
                }).catch(() => {
                    copyToClipboard(url);
                });
            } else {
                copyToClipboard(url);
            }
        }

        function copyToClipboard(url) {
            navigator.clipboard.writeText(url).then(() => {
                alert('Formation URL copied to clipboard!');
            }).catch(() => {
                const textArea = document.createElement('textarea');
                textArea.value = url;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Formation URL copied to clipboard!');
            });
        }

        function downloadImage() {
            // Track download event
            if (typeof gtag !== 'undefined') {
                gtag('event', 'download_image', {
                    'event_category': 'engagement',
                    'event_label': '6v6'
                });
            }
            
            const field = document.getElementById('field');
            
            // Check if mobile device
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth <= 768;
            
            if (typeof html2canvas !== 'undefined') {
                html2canvas(field, {
                    backgroundColor: '#0f5132',
                    scale: 2,
                    useCORS: true
                }).then(canvas => {
                    if (isMobile && navigator.share && navigator.canShare) {
                        // Mobile: Share image
                        canvas.toBlob(blob => {
                            const file = new File([blob], '6v6-formation.png', { type: 'image/png' });
                            if (navigator.canShare({ files: [file] })) {
                                navigator.share({
                                    title: '6v6 Football Formation',
                                    text: 'Check out this 6v6 formation!',
                                    files: [file]
                                }).catch(() => {
                                    // Fallback to download if share fails
                                    downloadCanvas(canvas, '6s-football-formation.png');
                                });
                            } else {
                                downloadCanvas(canvas, '6s-football-formation.png');
                            }
                        });
                    } else {
                        // Desktop: Download image
                        downloadCanvas(canvas, '6s-football-formation.png');
                    }
                });
            } else {
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';
                script.onload = () => {
                    downloadImage(); // Retry after loading
                };
                document.head.appendChild(script);
            }
        }

        function downloadCanvas(canvas, filename) {
            const link = document.createElement('a');
            link.download = filename;
            link.href = canvas.toDataURL();
            link.click();
        }

        function loadFromURL() {
            const hash = window.location.hash;
            if (hash.startsWith('#formation=')) {
                try {
                    const encodedData = hash.substring(11);
                    const formationData = JSON.parse(atob(encodedData));
                    
                    if (document.getElementById('myTeamFormation')) {
                        document.getElementById('myTeamFormation').value = formationData.myFormation || '221';
                    }
                    if (document.getElementById('oppTeamFormation')) {
                        document.getElementById('oppTeamFormation').value = formationData.oppFormation || '221';
                    }
                    
                    loadFormation();
                    
                    setTimeout(() => {
                        if (formationData.myTeamNames) {
                            document.querySelectorAll('.my-team .player-name').forEach((nameEl, index) => {
                                if (formationData.myTeamNames[index]) {
                                    nameEl.textContent = formationData.myTeamNames[index];
                                    const playerId = nameEl.parentElement.getAttribute('data-player-id');
                                    const input = document.querySelector(`input[data-player-id="${playerId}"]`);
                                    if (input) {
                                        input.value = formationData.myTeamNames[index];
                                    }
                                }
                            });
                        }
                        
                        if (formationData.oppTeamNames) {
                            document.querySelectorAll('.opp-team .player-name').forEach((nameEl, index) => {
                                if (formationData.oppTeamNames[index]) {
                                    nameEl.textContent = formationData.oppTeamNames[index];
                                    const playerId = nameEl.parentElement.getAttribute('data-player-id');
                                    const input = document.querySelector(`input[data-player-id="${playerId}"]`);
                                    if (input) {
                                        input.value = formationData.oppTeamNames[index];
                                    }
                                }
                            });
                        }
                    }, 100);
                } catch (e) {
                    console.error('Error loading formation from URL:', e);
                }
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            loadFromURL();
            loadNamesFromURL(); // Load names from URL parameter
            if (!window.location.hash.startsWith('#formation=')) {
                loadFormation();
            }
        });

        function loadNamesFromURL() {
            const currentMode = window.location.pathname.includes('7s') ? '7v7' : 
                               window.location.pathname.includes('6s') ? '6v6' : '11v11';
            
            // First try URL parameter (immediate transfer)
            const urlParams = new URLSearchParams(window.location.search);
            const namesData = urlParams.get('names');
            
            let playerNames = {};
            
            if (namesData) {
                try {
                    playerNames = JSON.parse(atob(namesData));
                } catch (e) {
                    console.error('Error loading player names from URL:', e);
                }
            }
            
            // Then load stored names for this mode (fills in missing names)
            try {
                const storedNames = localStorage.getItem(`footballLineup_${currentMode}`);
                if (storedNames) {
                    const stored = JSON.parse(storedNames);
                    // Merge stored names with URL names (URL takes priority)
                    playerNames = { ...stored, ...playerNames };
                }
            } catch (e) {
                console.error('Error loading stored names:', e);
            }
            
            // Apply names to inputs and field
            if (Object.keys(playerNames).length > 0) {
                setTimeout(() => {
                    Object.entries(playerNames).forEach(([playerId, name]) => {
                        const input = document.querySelector(`input[data-player-id="${playerId}"]`);
                        if (input) {
                            input.value = name;
                            updatePlayerName(playerId, name);
                        }
                    });
                }, 100);
            }
        }
    </script>
</body>
</html>
