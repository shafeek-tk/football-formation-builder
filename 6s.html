<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>6v6 Football Formation Builder | Easy Football Lineup - Create 6-a-side Soccer Formations</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- SEO Meta Tags -->
    <link rel="canonical" href="https://easyfootballlineup.com/6s.html">
    <meta name="description" content="Free 6v6 football formation builder. Create 6-a-side soccer lineups for futsal, indoor football, and small-sided games. No signup required - start building instantly.">
    
    <!-- Redirect www to non-www and enforce HTTPS -->
    <script>
        if (window.location.hostname === 'www.easyfootballlineup.com' || window.location.protocol === 'http:') {
            window.location.replace('https://easyfootballlineup.com' + window.location.pathname + window.location.search + window.location.hash);
        }
    </script>
    <meta name="keywords" content="6v6 football formation, 6-a-side soccer lineup, 6v6 tactics, futsal formations, small sided football, 6 aside soccer, football 6v6 strategy, 6 a side formation, six a side football, 6vs6 soccer, mini football formation, indoor football formation, futsal tactics, street football, cage football, 6 player football, six player soccer, small pitch football, compact formation, 6v6 coaching, football training formation, soccer drill formation, tactical setup 6v6, formation creator 6v6, lineup maker 6v6, team sheet 6v6, squad builder 6v6, football manager 6v6, coaching board 6v6, tactical board 6v6, formation planner 6v6, soccer strategy 6v6, football analysis 6v6, match preparation 6v6, team tactics 6v6, player positioning 6v6, field setup 6v6, game plan 6v6, european futsal, asian futsal, south american futsal, indoor soccer formation, street soccer tactics, recreational football, amateur football 6v6, social football, corporate football, workplace football, community football, park football, beach football 6v6, artificial turf football, 3g pitch football, 4g pitch football, astroturf football, synthetic pitch football, leisure football, casual football, pickup football, informal football, weekend football, evening football, after work football, lunch break football, holiday football, vacation football, tournament football 6v6, league football 6v6, cup football 6v6, championship 6v6, competition 6v6, friendly 6v6, scrimmage 6v6, practice 6v6, training 6v6, drill 6v6, exercise 6v6, workout 6v6, fitness 6v6, conditioning 6v6, skill development 6v6, technique 6v6, tactics 6v6, strategy 6v6, game plan 6v6, match analysis 6v6, performance 6v6, improvement 6v6, coaching 6v6, instruction 6v6, guidance 6v6, mentoring 6v6, teaching 6v6, learning 6v6, education 6v6, development 6v6, progression 6v6, advancement 6v6">
    <meta name="geo.region" content="GB, DE, FR, IT, ES, NL, PT, BE, AT, CH, SE, NO, DK, FI, IS, IE, PL, CZ, SK, HU, RO, BG, HR, SI, EE, LV, LT, GR, CY, MT, LU, BR, AR, CO, PE, CL, EC, UY, PY, BO, VE, GY, SR, GF, JP, KR, CN, IN, TH, VN, MY, SG, ID, PH, AU, NZ, MX, US, CA">
    <meta name="geo.placename" content="Europe, Asia, South America, Global">
    
    <!-- Open Graph meta tags -->
    <meta property="og:title" content="6v6 Football Formation Builder - Create 6-a-side Soccer Lineups">
    <meta property="og:description" content="Free online 6v6 football formation creator. Perfect for futsal, indoor football, and small-sided games worldwide.">
    <meta property="og:url" content="https://easyfootballlineup.com/6s.html">
    <meta property="og:locale" content="en_GB">
    <meta property="og:locale:alternate" content="en_US">
    <meta property="og:locale:alternate" content="es_ES">
    <meta property="og:locale:alternate" content="pt_BR">
    <meta property="og:locale:alternate" content="de_DE">
    <meta property="og:locale:alternate" content="fr_FR">
    <meta property="og:locale:alternate" content="it_IT">
    <meta property="og:locale:alternate" content="nl_NL">
    <meta property="og:locale:alternate" content="ja_JP">
    <meta property="og:locale:alternate" content="ko_KR">
    <meta property="og:locale:alternate" content="zh_CN">
    <meta property="og:locale:alternate" content="hi_IN">
    <meta property="og:locale:alternate" content="th_TH">
    <meta property="og:locale:alternate" content="vi_VN">
    
    <!-- Twitter Card meta tags -->
    <meta name="twitter:title" content="6v6 Football Formation Builder - Futsal & Indoor Soccer Tactics">
    <meta name="twitter:description" content="Create professional 6-a-side football formations for futsal, indoor soccer, and recreational football.">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚öΩ</text></svg>">
    
    <!-- Common Pitch Styles -->
    <link rel="stylesheet" href="pitch-styles.css?v=8&t=1735781500">
    <script src="pitch-common.js?v=8&t=1735781500"></script>
    <script src="player-names.js"></script>
    
    <!-- LZ-string compression library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"></script>
    
    <!-- Cache buster - update timestamp when making changes -->
    <script>window.cacheVersion = '20260104-1534';</script>

    
    <!-- Schema.org structured data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Easy Football Lineup - 6v6",
      "description": "Free online 6v6 football formation builder and soccer lineup creator",
      "url": "https://easyfootballlineup.com/6s.html",
      "applicationCategory": "SportsApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "creator": {
        "@type": "Organization",
        "name": "Easy Football Lineup"
      }
    }
    </script>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BGH9W2K44G"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-BGH9W2K44G');
    </script>
    
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Oswald',system-ui,sans-serif;background:#1a1a1a;color:#fff;padding:10px;letter-spacing:0.5px}
        
        .header{text-align:center;margin-bottom:20px}
        .header h1{font-size:24px;margin-bottom:15px;letter-spacing:2px}
        .controls{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:20px}
        .controls select,.controls button{padding:8px 12px;background:#333;color:#fff;border:1px solid #555;border-radius:4px;font-size:14px}
        .controls button{background:#007acc;cursor:pointer}
        .controls button:hover{background:#005a99}
        
        /* Mobile/Desktop text switching */
        .mobile-text{display:none}
        .desktop-text{display:inline}
        
        @media (max-width:768px){
            .mobile-text{display:inline}
            .desktop-text{display:none}
        }
        
        .formation-container{display:flex;gap:15px;justify-content:center;margin-bottom:30px;flex-wrap:wrap}
        .formation-group{display:flex;align-items:center;gap:10px}
        .formation-label{font-size:14px;color:#aaa;font-weight:500;letter-spacing:0.5px;white-space:nowrap}
        .formation-select{padding:10px 35px 10px 14px;background:#333;color:#fff;border:1px solid #555;border-radius:6px;font-family:'Oswald',sans-serif;font-size:15px;font-weight:500;cursor:pointer;transition:all 0.2s ease;appearance:none;background-image:url("data:image/svg+xml,%3Csvg width='10' height='6' viewBox='0 0 10 6' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L5 5L9 1' stroke='%23aaa' stroke-width='1.5' stroke-linecap='round'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;min-width:120px}
        .formation-select:hover{border-color:#007acc;background-color:#3a3a3a}
        .formation-select:focus{outline:none;border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,0.2)}
        .formation-select option{background:#2a2a2a;color:#fff;padding:10px}
        
        .player{position:absolute;transform:translate(-50%,-50%);text-align:center;cursor:pointer;z-index:10}
        .player-icon{width:min(6vw,22px);height:min(6vw,22px);margin:0 auto;background-size:contain;background-repeat:no-repeat;background-position:center}
        .my-team .player-icon{background-image:url('blue-jersey.png')}
        .opp-team .player-icon{background-image:url('red-jersey.png')}
        .player-number{position:absolute;top:30%;left:50%;transform:translate(-50%,-50%);font-size:min(1.6vw,6px);font-weight:bold;color:#fff;text-shadow:1px 1px 1px rgba(0,0,0,0.8)}
        .player-name{font-size:min(2vw,8px);margin-top:0px;padding:2px 4px;background:linear-gradient(135deg,rgba(0,0,0,0.9),rgba(0,0,0,0.7));border-radius:3px;color:#fff;font-weight:bold;max-width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;border:1px solid rgba(255,255,255,0.2);box-shadow:0 1px 3px rgba(0,0,0,0.5);text-shadow:1px 1px 2px rgba(0,0,0,0.8);transition:all 0.2s ease;min-height:14px;display:block;cursor:pointer}
        .player-name:hover{background:linear-gradient(135deg,rgba(0,0,0,0.95),rgba(0,0,0,0.8));border-color:rgba(255,255,255,0.4);box-shadow:0 2px 5px rgba(0,0,0,0.7);transform:scale(1.05);border-color:#4CAF50}
        .player-name:hover::after{content:" ‚úèÔ∏è";font-size:7px;opacity:0.8}
        .player-name-input{font-size:9px;margin-top:2px;padding:1px 3px;background:#fff;border-radius:2px;border:1px solid #007acc;color:#000;width:35px;text-align:center}
        
        .field:hover .player-name {
            border-color: #4CAF50 !important;
            box-shadow: 0 0 8px rgba(76, 175, 80, 0.4) !important;
        }
        
        .field:hover .player-name::after {
            content: " ‚úèÔ∏è";
            font-size: 7px;
            opacity: 0.8;
        }
        
        .footer{position:fixed;bottom:5px;right:5px;font-size:10px;color:#aaa;opacity:0.8}
        .footer a{color:#aaa;text-decoration:none}
        
        .mode-toggle{position:fixed;top:20px;right:20px;z-index:1000;display:flex;gap:8px}
        .mode-btn{padding:12px 24px;background:#007acc;color:#fff;border:none;border-radius:8px;font-size:16px;font-weight:600;box-shadow:0 2px 8px rgba(0,0,0,0.3);transition:all 0.2s ease;cursor:pointer;min-width:80px;letter-spacing:1px}
        .mode-btn:hover{background:#005a99;transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,0.4)}
        .mode-btn.active{background:#28a745;box-shadow:0 2px 8px rgba(40,167,69,0.4)}
        
        .player-controls{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:20px;max-width:800px;margin-left:auto;margin-right:auto}
        .team-section{background:#2a2a2a;padding:15px;border-radius:8px}
        .team-section h3{margin-bottom:10px;font-size:16px;color:#ccc}
        .team-section select{width:100%;padding:8px;background:#333;color:#fff;border:1px solid #555;border-radius:4px;margin-bottom:15px}
        .player-input{width:100%;padding:6px;margin:0;background:#333;color:#fff;border:1px solid #555;border-radius:4px;font-size:12px;min-width:120px}
        .input-label{display:flex;align-items:center;gap:8px;margin:3px 0;}
        .input-number{color:#ccc;font-weight:bold;min-width:35px;font-size:11px}
        
        @media (max-width:768px){
            .controls{flex-direction:column;align-items:center}
            .controls select,.controls button{width:200px}
            .player-controls{grid-template-columns:1fr;gap:15px}
            .mode-toggle{position:relative;top:auto;right:auto;margin-top:15px;justify-content:center;gap:4px}
            .mode-btn{padding:6px 12px;font-size:12px;min-width:50px;letter-spacing:0}
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>EASY FOOTBALL LINEUP - 6v6</h1>
        <p style="color:#ccc;font-size:16px;margin-bottom:15px;max-width:600px;margin-left:auto;margin-right:auto;">Build your 6-a-side formation and get an instant shareable link. No saving, no accounts - just share.</p>
        <div class="controls">
            <button onclick="shareFormation()">SHARE FORMATION</button>
            <button onclick="downloadImage()" id="downloadBtn">
                <span class="desktop-text">DOWNLOAD IMAGE</span>
                <span class="mobile-text">SHARE IMAGE</span>
            </button>
        </div>
        <div class="formation-container">
            <div class="formation-group">
                <span class="formation-label">Home:</span>
                <select id="myTeamFormation" onchange="loadFormation()" class="formation-select">
                    <option value="221">2-2-1</option>
                    <option value="212">2-1-2</option>
                    <option value="311">3-1-1</option>
                    <option value="131">1-3-1</option>
                    <option value="122">1-2-2</option>
                </select>
            </div>
            <div class="formation-group">
                <span class="formation-label">Away:</span>
                <select id="oppTeamFormation" onchange="changeAwayFormation()" class="formation-select">
                    <option value="221">2-2-1</option>
                    <option value="212">2-1-2</option>
                    <option value="311">3-1-1</option>
                    <option value="131">1-3-1</option>
                    <option value="122">1-2-2</option>
                </select>
            </div>
        </div>
        <div class="mode-toggle">
            <button class="mode-btn" onclick="switchMode('index.html')">11v11</button>
            <button class="mode-btn" onclick="switchMode('7s.html')">7v7</button>
            <button class="mode-btn active">6v6</button>
        </div>
    </div>
    
    <div style="text-align:center;color:#ccc;font-size:14px;margin:15px 0;background:rgba(0,0,0,0.3);padding:8px;border-radius:6px;max-width:300px;margin:15px auto;letter-spacing:0.5px;">
        üí° Click on player names to edit them directly
    </div>
    
    <div class="field-container">
        <div class="field format-6s" id="field">
        </div>
    </div>
    

    
    <div style="text-align:center;padding:20px;background:#2a2a2a;margin:20px auto;max-width:800px;border-radius:8px;">
        <h3 style="color:#fff;margin-bottom:15px;font-size:18px;">Why coaches and players love this tool:</h3>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;text-align:left;">
            <div style="color:#ccc;">
                <strong style="color:#fff;">üîó Instant Shareable Links</strong><br>
                Create formations and get shareable links instantly - no saving needed
            </div>
            <div style="color:#ccc;">
                <strong style="color:#fff;">üöÄ No Setup Required</strong><br>
                No saving, no accounts, no setup - just open and start creating
            </div>
            <div style="color:#ccc;">
                <strong style="color:#fff;">üì± Works Everywhere</strong><br>
                Use on any device - phone, tablet, or computer
            </div>
        </div>
    </div>
    
    <div class="footer">
        <a target="_blank" href="https://icons8.com/icon/y1jile6KU9QN/t-shirt">t shirt</a> icon by <a target="_blank" href="https://icons8.com">Icons8</a> | 
        Need help? <a href="mailto:easyfootballlineup@gmail.com">easyfootballlineup@gmail.com</a>
    </div>

    <script>
        // 6-a-side formations (6 players per team)
        const formations = {
            '221': [[50], [25, 75], [25, 75], [50]], // 2-2-1: GK, 2 defenders, 2 midfielders, 1 striker
            '131': [[50], [50], [20, 50, 80], [50]], // 1-3-1: GK, 1 defender, 3 midfielders, 1 striker
            '212': [[50], [25, 75], [50], [35, 65]], // 2-1-2: GK, 2 defenders, 1 midfielder, 2 strikers
            '122': [[50], [50], [25, 75], [25, 75]], // 1-2-2: GK, 1 defender, 2 midfielders, 2 strikers
            '311': [[50], [20, 50, 80], [50], [50]] // 3-1-1: GK, 3 defenders, 1 midfielder, 1 striker
        };

        function getLayerY(layerIndex, totalLayers, isMyTeam) {
            if (layerIndex === 0) {
                return isMyTeam ? 95 : 5;
            }
            
            const outfieldLayers = totalLayers - 1;
            const outfieldIndex = layerIndex - 1;
            
            let y;
            if (isMyTeam) {
                if (outfieldLayers === 1) {
                    y = 70;
                } else {
                    const spacing = 30 / (outfieldLayers - 1);
                    y = 85 - (spacing * outfieldIndex);
                }
            } else {
                if (outfieldLayers === 1) {
                    y = 30;
                } else {
                    const spacing = 30 / (outfieldLayers - 1);
                    y = 15 + (spacing * outfieldIndex);
                }
            }
            
            return y;
        }

        function getPlayerY(layerIndex, playerIndex, totalLayers, layerSize, isMyTeam) {
            const baseY = getLayerY(layerIndex, totalLayers, isMyTeam);
            
            if (layerSize >= 3) {
                const isWidePlayer = playerIndex === 0 || playerIndex === layerSize - 1;
                if (isWidePlayer) {
                    return isMyTeam ? baseY - 2 : baseY + 2;
                }
            }
            
            return baseY;
        }

        function createPlayer(x, y, position, team, index, sequentialIndex = null) {
            const player = document.createElement('div');
            player.className = `player ${team}`;
            player.style.left = x + '%';
            player.style.top = y + '%';
            const playerId = `${team}-${index}`;
            const playerNumber = Math.floor(index/10) + (index%10) + 1;
            const teamPrefix = team === 'my-team' ? 'MT' : 'OPP';
            const bestPlayers = ['NEUER', 'MBAPPE', 'RUDIGER', 'RONALDO', 'PEDRI', 'MODRIC'];
            const playerName = team === 'my-team' ? (bestPlayers[sequentialIndex !== null ? sequentialIndex : index] || `Player ${playerNumber}`) : '';
            player.setAttribute('data-player-id', playerId);
            player.innerHTML = `
                <div class="player-icon">
                    <div class="player-number">${playerNumber}</div>
                </div>
                <div class="player-name" onclick="editPlayerName(this)">${playerName}</div>
            `;
            return player;
        }

        function loadFormation() {
            const field = document.getElementById('field');
            
            const myFormation = document.getElementById('myTeamFormation')?.value || '221';
            const oppFormation = document.getElementById('oppTeamFormation')?.value || '221';
            
            const existingInputValues = {};
            document.querySelectorAll('input[data-player-id]').forEach(input => {
                const playerId = input.getAttribute('data-player-id');
                if (playerId && input.value.trim()) {
                    existingInputValues[playerId] = input.value;
                }
            });
            
            const myTeamNames = [];
            const oppTeamNames = [];
            document.querySelectorAll('.my-team .player-name').forEach(nameEl => {
                const name = nameEl.textContent;
                if (name && name.trim() && !name.startsWith('MT') && !name.startsWith('Player')) {
                    myTeamNames.push(name);
                }
            });
            document.querySelectorAll('.opp-team .player-name').forEach(nameEl => {
                const name = nameEl.textContent;
                if (name && name.trim() && !name.startsWith('OPP') && !name.startsWith('Player')) {
                    oppTeamNames.push(name);
                }
            });
            
            // Store names in localStorage for cross-format preservation
            if (myTeamNames.length > 0) {
                localStorage.setItem('homeTeamNames', JSON.stringify(myTeamNames));
            }
            if (oppTeamNames.length > 0) {
                localStorage.setItem('awayTeamNames', JSON.stringify(oppTeamNames));
            }
            
            field.querySelectorAll('.player').forEach(p => p.remove());
            
            const F = formations[myFormation];
            const O = formations[oppFormation];
            
            // Create field players
            let sequentialCounter = 0;
            F.forEach((layer, layerIndex) => {
                layer.forEach((x, playerIndex) => {
                    const y = getPlayerY(layerIndex, playerIndex, F.length, layer.length, true);
                    const player = createPlayer(x, y, 'P', 'my-team', layerIndex * 10 + playerIndex, sequentialCounter);
                    field.appendChild(player);
                    sequentialCounter++;
                });
            });
            
            O.forEach((layer, layerIndex) => {
                layer.forEach((x, playerIndex) => {
                    const y = getPlayerY(layerIndex, playerIndex, O.length, layer.length, false);
                    const player = createPlayer(x, y, 'P', 'opp-team', layerIndex * 10 + playerIndex);
                    field.appendChild(player);
                });
            });
            
            createPlayerInputs('myTeamInputs', F, 'Home Team');
            createPlayerInputs('oppTeamInputs', O, 'Away Team');
            
            // Restore names
            Object.keys(existingInputValues).forEach(playerId => {
                const inputField = document.querySelector(`input[data-player-id="${playerId}"]`);
                if (inputField) {
                    inputField.value = existingInputValues[playerId];
                    updatePlayerName(playerId, existingInputValues[playerId]);
                }
            });
            
            const myTeamElements = document.querySelectorAll('.my-team .player-name');
            let myTeamIndex = 0;
            myTeamElements.forEach(nameEl => {
                const currentName = nameEl.textContent;
                if ((!currentName || currentName.startsWith('MT') || currentName.startsWith('Player')) && myTeamIndex < myTeamNames.length) {
                    nameEl.textContent = myTeamNames[myTeamIndex];
                    myTeamIndex++;
                }
            });
            
            const oppTeamElements = document.querySelectorAll('.opp-team .player-name');
            let oppTeamIndex = 0;
            oppTeamElements.forEach(nameEl => {
                const currentName = nameEl.textContent;
                if ((!currentName || currentName.startsWith('OPP') || currentName.startsWith('Player')) && oppTeamIndex < oppTeamNames.length) {
                    nameEl.textContent = oppTeamNames[oppTeamIndex];
                    oppTeamIndex++;
                }
            });
        }

        function createPlayerInputs(containerId, formation, teamName) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            container.innerHTML = '';
            let playerCount = 0;
            
            formation.forEach((layer, layerIndex) => {
                layer.forEach((x, playerIndex) => {
                    const playerNumber = playerCount + 1;
                    const displayPrefix = teamName.toLowerCase().includes('home') ? 'MT' : 'OPP';
                    const defaultValue = teamName.toLowerCase().includes('home') ? `${displayPrefix}${playerNumber}` : '';
                    const input = document.createElement('input');
                    input.className = 'player-input';
                    input.placeholder = `${displayPrefix}${playerNumber}`;
                    input.value = defaultValue;
                    const teamPrefix = teamName.toLowerCase().includes('home') ? 'my-team' : 'opp-team';
                    const playerId = `${teamPrefix}-${layerIndex * 10 + playerIndex}`;
                    input.setAttribute('data-player-id', playerId);
                    
                    const label = document.createElement('div');
                    label.className = 'input-label';
                    label.innerHTML = `<span class="input-number">#${playerNumber}</span>`;
                    label.appendChild(input);
                    
                    input.addEventListener('input', function() {
                        updatePlayerName(playerId, this.value);
                    });
                    
                    input.addEventListener('focus', function() {
                        this.select();
                    });
                    
                    input.addEventListener('keydown', function(e) {
                        if (e.key === 'Tab') {
                            e.preventDefault();
                            const inputs = container.querySelectorAll('.player-input');
                            const currentIndex = Array.from(inputs).indexOf(this);
                            const nextIndex = (currentIndex + 1) % inputs.length;
                            inputs[nextIndex].focus();
                        }
                    });
                    
                    container.appendChild(label);
                    playerCount++;
                });
            });
        }

        function changeAwayFormation() {
            loadFormation();
        }

        function shareFormation() {
            // Track share event
            if (typeof gtag !== 'undefined') {
                gtag('event', 'share_formation', {
                    'event_category': 'engagement',
                    'event_label': '6v6'
                });
            }
            
            // Collect formation data with optimized structure
            const h = document.getElementById('myTeamFormation')?.value || '221';
            const a = document.getElementById('oppTeamFormation')?.value || '221';
            
            // Collect only non-default names to reduce size
            const hn = [];
            const an = [];
            
            document.querySelectorAll('.my-team .player-name').forEach((nameEl, i) => {
                const name = nameEl.textContent;
                const defaultNames = ['NEUER', 'MBAPPE', 'RUDIGER', 'RONALDO', 'PEDRI', 'MODRIC'];
                if (name && !defaultNames.includes(name) && !name.startsWith('Player ')) {
                    hn[i] = name;
                }
            });
            
            document.querySelectorAll('.opp-team .player-name').forEach((nameEl, i) => {
                const name = nameEl.textContent;
                if (name && name.trim() && !name.startsWith('OPP') && !name.startsWith('Player ')) {
                    an[i] = name;
                }
            });
            
            // Ultra-compact format: only include non-empty arrays
            const data = [h, a];
            const hasHomeNames = hn.some(n => n);
            const hasAwayNames = an.some(n => n);
            
            if (hasHomeNames || hasAwayNames) {
                data.push(hasHomeNames ? hn : []);
                if (hasAwayNames) {
                    data.push(an);
                }
            }
            
            // Ultra-compact encoding using LZ-string URI encoding
            let finalData;
            if (typeof LZString !== 'undefined') {
                finalData = LZString.compressToEncodedURIComponent(JSON.stringify(data));
            } else {
                finalData = btoa(JSON.stringify(data));
            }
            
            const url = (window.location.origin !== 'null' ? window.location.origin : 'https://easyfootballlineup.com') + window.location.pathname + '#f=' + finalData;
            
            shareURL(url);
        }

        // Custom base36 encoding (uppercase + numbers only)
        function toBase36(str) {
            const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            let result = '';
            for (let i = 0; i < str.length; i++) {
                const code = str.charCodeAt(i);
                result += chars[code % 36] + chars[Math.floor(code / 36) % 36];
            }
            return result.replace(/[^A-Z0-9]/g, '').toUpperCase();
        }

        function fromBase36(str) {
            const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const cleaned = str.replace(/[^A-Z0-9]/g, '').toUpperCase();
            let result = '';
            for (let i = 0; i < cleaned.length; i += 2) {
                const a = chars.indexOf(cleaned[i]);
                const b = chars.indexOf(cleaned[i + 1] || '0');
                if (a >= 0 && b >= 0) {
                    result += String.fromCharCode(a + b * 36);
                }
            }
            return result;
        }

        function shareURL(url) {
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth <= 768;
            
            if (isMobile && navigator.share) {
                navigator.share({
                    title: '6-a-side Football Formation Builder',
                    text: 'Check out this 6v6 football formation!',
                    url: url
                }).catch(() => {
                    copyToClipboard(url);
                });
            } else {
                copyToClipboard(url);
            }
        }

        function copyToClipboard(url) {
            navigator.clipboard.writeText(url).then(() => {
                alert('Formation URL copied to clipboard!');
            }).catch(() => {
                const textArea = document.createElement('textarea');
                textArea.value = url;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Formation URL copied to clipboard!');
            });
        }

        function downloadImage() {
            // Track download event
            if (typeof gtag !== 'undefined') {
                gtag('event', 'download_image', {
                    'event_category': 'engagement',
                    'event_label': '6v6'
                });
            }
            
            const field = document.getElementById('field');
            
            // Check if mobile device
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth <= 768;
            
            if (typeof html2canvas !== 'undefined') {
                html2canvas(field, {
                    backgroundColor: '#0f5132',
                    scale: 2,
                    useCORS: true
                }).then(canvas => {
                    if (isMobile && navigator.share && navigator.canShare) {
                        // Mobile: Share image
                        canvas.toBlob(blob => {
                            const file = new File([blob], '6v6-formation.png', { type: 'image/png' });
                            if (navigator.canShare({ files: [file] })) {
                                navigator.share({
                                    title: '6v6 Football Formation',
                                    text: 'Check out this 6v6 formation!',
                                    files: [file]
                                }).catch(() => {
                                    // Fallback to download if share fails
                                    downloadCanvas(canvas, '6s-football-formation.png');
                                });
                            } else {
                                downloadCanvas(canvas, '6s-football-formation.png');
                            }
                        });
                    } else {
                        // Desktop: Download image
                        downloadCanvas(canvas, '6s-football-formation.png');
                    }
                });
            } else {
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';
                script.onload = () => {
                    downloadImage(); // Retry after loading
                };
                document.head.appendChild(script);
            }
        }

        function downloadCanvas(canvas, filename) {
            try {
                const link = document.createElement('a');
                link.download = filename;
                link.href = canvas.toDataURL();
                link.click();
            } catch (error) {
                console.error('Download failed:', error);
                alert('Download failed. Please use a web server (not file://) to enable image downloads.');
            }
        }

        function loadFromURL() {
            const hash = window.location.hash;
            const urlParams = new URLSearchParams(window.location.search);
            const queryF = urlParams.get('f');
            
            if (hash.startsWith('#formation=') || hash.startsWith('#f=') || queryF) {
                try {
                    let encodedData;
                    if (queryF) {
                        encodedData = queryF;
                    } else {
                        encodedData = hash.startsWith('#f=') ? hash.substring(3) : hash.substring(11);
                    }
                    
                    let data;
                    
                    // Try LZ-string decompression
                    if (typeof LZString !== 'undefined') {
                        try {
                            const decompressed = LZString.decompressFromEncodedURIComponent(encodedData);
                            if (!decompressed) {
                                throw new Error('LZ URI decompression failed');
                            }
                            data = JSON.parse(decompressed);
                        } catch (e) {
                            // Fallback to base64
                            data = JSON.parse(atob(encodedData));
                        }
                    } else {
                        data = JSON.parse(atob(encodedData));
                    }
                    
                    let formationData;
                    // Handle both old and new formats
                    if (Array.isArray(data)) {
                        // New compact format: [homeFormation, awayFormation, homeNames?, awayNames?]
                        formationData = {
                            myFormation: data[0] || '221',
                            oppFormation: data[1] || '221',
                            myTeamNames: data[2] || [],
                            oppTeamNames: data[3] || []
                        };
                    } else {
                        // Old format compatibility
                        formationData = data;
                    }
                    
                    if (document.getElementById('myTeamFormation')) {
                        document.getElementById('myTeamFormation').value = formationData.myFormation || '221';
                    }
                    if (document.getElementById('oppTeamFormation')) {
                        document.getElementById('oppTeamFormation').value = formationData.oppFormation || '221';
                    }
                    
                    loadFormation();
                    
                    setTimeout(() => {
                        if (formationData.myTeamNames) {
                            document.querySelectorAll('.my-team .player-name').forEach((nameEl, index) => {
                                if (formationData.myTeamNames[index]) {
                                    nameEl.textContent = formationData.myTeamNames[index];
                                }
                            });
                        }
                        if (formationData.oppTeamNames) {
                            document.querySelectorAll('.opp-team .player-name').forEach((nameEl, index) => {
                                if (formationData.oppTeamNames[index]) {
                                    nameEl.textContent = formationData.oppTeamNames[index];
                                }
                            });
                        }
                    }, 100);
                } catch (e) {
                    console.error('Error loading formation from URL:', e);
                    loadFormation();
                }
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            initializePitch(); // Load common pitch markings
            loadFromURL();
            loadNamesFromURL(); // Load names from URL parameter
            
            const urlParams = new URLSearchParams(window.location.search);
            const queryF = urlParams.get('f');
            
            if (!window.location.hash.startsWith('#formation=') && !window.location.hash.startsWith('#f=') && !queryF) {
                loadFormation();
                restoreNamesFromStorage(); // Restore names from localStorage if no URL data
            }
            initializePlayerNames(); // Initialize global player names
        });

        function restoreNamesFromStorage() {
            setTimeout(() => {
                try {
                    const savedHomeNames = localStorage.getItem('homeTeamNames');
                    const savedAwayNames = localStorage.getItem('awayTeamNames');
                    
                    if (savedHomeNames) {
                        const homeNames = JSON.parse(savedHomeNames);
                        document.querySelectorAll('.my-team .player-name').forEach((nameEl, index) => {
                            if (index < homeNames.length && (!nameEl.textContent || nameEl.textContent.startsWith('MT') || nameEl.textContent.startsWith('Player'))) {
                                nameEl.textContent = homeNames[index];
                            }
                        });
                    }
                    
                    if (savedAwayNames) {
                        const awayNames = JSON.parse(savedAwayNames);
                        document.querySelectorAll('.opp-team .player-name').forEach((nameEl, index) => {
                            if (index < awayNames.length && (!nameEl.textContent || nameEl.textContent.startsWith('OPP') || nameEl.textContent.startsWith('Player'))) {
                                nameEl.textContent = awayNames[index];
                            }
                        });
                    }
                } catch (e) {
                    console.error('Error restoring names from storage:', e);
                }
            }, 200);
        }

        function loadNamesFromURL() {
            const currentMode = window.location.pathname.includes('7s') ? '7v7' : 
                               window.location.pathname.includes('6s') ? '6v6' : '11v11';
            
            // First try URL parameter (immediate transfer)
            const urlParams = new URLSearchParams(window.location.search);
            const namesData = urlParams.get('names');
            
            let playerNames = {};
            
            if (namesData) {
                try {
                    playerNames = JSON.parse(atob(namesData));
                } catch (e) {
                    console.error('Error loading player names from URL:', e);
                }
            }
            
            // Then load stored names for this mode (fills in missing names)
            try {
                const storedNames = localStorage.getItem(`footballLineup_${currentMode}`);
                if (storedNames) {
                    const stored = JSON.parse(storedNames);
                    // Merge stored names with URL names (URL takes priority)
                    playerNames = { ...stored, ...playerNames };
                }
            } catch (e) {
                console.error('Error loading stored names:', e);
            }
            
            // Apply names to inputs and field
            if (Object.keys(playerNames).length > 0) {
                setTimeout(() => {
                    Object.entries(playerNames).forEach(([playerId, name]) => {
                        const input = document.querySelector(`input[data-player-id="${playerId}"]`);
                        if (input) {
                            input.value = name;
                            updatePlayerName(playerId, name);
                        }
                    });
                }, 100);
            }
        }
    </script>
</body>
</html>
